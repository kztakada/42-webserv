#!/usr/bin/env bash
set -euo pipefail

# 手動テスト用: 全面ホワイトの最小 JPEG(1x1) を書き出します。
# 外部画像生成ツール(ImageMagick等)を前提にしないため、base64 埋め込みを decode します。

script_dir=$(cd -- "$(dirname -- "$0")" && pwd)
fixtures_dir="$script_dir/fixtures"
out="$fixtures_dir/white.jpg"

mkdir -p "$fixtures_dir"

base64 -d >"$out" <<'B64'
/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAALCAAaABoBAREA/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHqP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEAAQUCj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8Bj//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8Bj//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cj//Z
B64

# 簡易チェック: JPEG SOI/EOI
OUT="$out" python3 - <<'PY'
import os

p = os.environ['OUT']
raw = open(p, 'rb').read()
assert raw[:2] == b'\xff\xd8' and raw[-2:] == b'\xff\xd9'
print('ok:', p, 'bytes=', len(raw))
PY

printf 'wrote %s\n' "$out"
